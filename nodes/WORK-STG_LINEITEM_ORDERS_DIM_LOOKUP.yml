steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-6ed5600f-8305-4e4b-9679-51f0016b5eea:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 1e1981ae-ff1a-4bfa-b47c-5f8d20de66cf
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 38e1b387-0a1e-494c-ac5f-4c7ef160075d
                    stepCounter: 6bad6740-4353-4346-a84a-38256591efe9
                transform: ""
          - columnReference:
              columnCounter: 83f02cc5-3952-4fe3-9173-77f5879e9db8
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3062998c-865a-4a8b-a659-b36334d64e04
                    stepCounter: 39ab4343-9bb4-4420-b88b-5a6500bde274
                transform: ""
          - columnReference:
              columnCounter: 7e63700a-9b32-4da6-a4f3-50069e70d8d2
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 168054c1-7506-4b60-b4e8-2b49d2ee9750
                    stepCounter: 98c9c7ae-0708-4403-a11f-da4f9c426304
                transform: ""
          - columnReference:
              columnCounter: ca06f4ba-d2b9-4a1d-8e75-0595cf6bf97a
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0f51f870-91ae-493a-8ea3-a02eee528568
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 5de8bdbc-ea4b-4d59-bc01-157653565618
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6af6e828-b591-4da3-98c4-88a087d6ef36
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 956c0de6-fcd7-486b-a928-cc98a81babfb
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d86dca4b-6e90-4aa3-9c0c-1c3c4938e13a
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: a4d31589-5183-43e1-b530-f459967c2cf2
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fa913202-4422-45d4-bdc2-400a35c4a2ec
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 104f26ee-50c5-4511-a72d-f2f5e8c169fc
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b25faebf-5f75-4e9a-af8b-ddfd91cdf743
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: affc9c57-b5a1-40e0-93da-61043344c2f7
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b12d92a6-eefc-4088-a14e-9a01cffc82cf
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 73bef04a-5b57-41b0-9689-e0c99b54acd9
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5d7e65d7-cfd5-4315-a78f-9fe09a2c5509
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 85fcb455-c19d-4795-b87b-25e663136f5d
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d6540c1c-3f6a-4329-b0bb-918a3c9db81d
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 19bc00fd-bb0b-48e7-ad0b-c615b5f9151b
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 21747162-4fc0-422e-bf57-9048061ad5dd
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 11082a32-4125-4d96-851e-4f21919eef94
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5555be3e-41c4-40f8-9b7b-20436e73a590
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 72641502-8e20-4a00-8b14-4dc06949dfd1
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 468dd345-d8cd-401c-a5bd-849cb811f0c2
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 2161f7fb-56e1-4023-b1cb-d4fdac0ecd44
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6e3f7b33-f12b-4915-8d2a-e28403fa928d
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: a41c880c-1f93-4444-8080-b12cb48de750
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 609b778c-322d-4ec3-a1ff-55ccccadc5ad
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: fcc1f28c-3ab9-48df-9b2a-8b8438d6dc19
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1fc80828-42b9-40a2-b371-edc5f89d0ed0
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 2188cd8e-2af4-4a4a-93bf-afed32c3dc2e
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6d7207bc-d246-489d-b1f0-44bd5682845a
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: e7f0ffc1-3388-40bc-8c42-1e0ce93c8d34
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 398fd233-2440-439a-931d-4e9d48aaf264
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: aa372910-1109-4dff-b98c-6986f60814df
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 81f35b70-257a-4323-aa41-790da46f89ea
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 1cb0faee-f499-448c-8834-a48f44646825
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 57d3bdad-c424-4587-b650-2593470d296b
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 5dfaf44c-94bc-42ee-958e-493de114ca1a
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 41ca6f6f-e1ef-461e-876d-39e9d7e8fecf
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: f84e9504-ca2a-4a66-b558-c528839d4a15
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0ec13f8c-bee7-42f3-bd68-90248c225d07
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: f02fb62c-dc1e-4b8c-bfd7-2050fe6a5aa5
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f022e385-c43e-4753-b524-a581753c37e9
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 947e2512-105a-497e-bdc6-a4ec89de0ea6
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 11145064-f57a-460c-9146-919499014abc
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: b4ec851d-fe9c-416c-9e91-3304270f9094
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8494eefd-0e08-401b-b330-054b8a8e9255
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: b6171dd6-623b-4907-a4db-1b8426663a98
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: acdbca81-cec8-48ef-9edc-d00a364aaf5c
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 41267d9d-cd23-416d-b455-2db56e022cbd
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5de8fd20-2a45-4467-a5c0-b6064d8344c2
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 50fb4bed-f20e-4660-a2a6-de807e2ec52d
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fcddbc79-0d2b-47a0-8d63-9fe0b3136356
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - columnReference:
              columnCounter: 4d59ee9e-b3aa-448b-8ed6-608d6b7facb9
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6cdb8733-722e-46a0-b461-b4516ab48249
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 89a39b69-3f9d-46fb-b707-9cb60e57fb1f
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4887ed33-1cdc-4db4-b98a-4157851ff47e
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: c8d97ff6-c7bf-4231-abf5-76bd221ba7d6
              stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1b39bd9a-ac74-44dc-9b05-b1555c6fc035
                    stepCounter: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 6bad6740-4353-4346-a84a-38256591efe9
              DIM_PART: 39ab4343-9bb4-4420-b88b-5a6500bde274
              DIM_SUPPLIER: 98c9c7ae-0708-4403-a11f-da4f9c426304
              STG_ORDERS_LINEITEM: 72bfec18-56d2-449d-8f55-0ed9b5eb7503
              STG_PARTSUPP: 5b139933-2b44-45f6-94d4-eb7e51bf3ef1
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_ORDERS_LINEITEM
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_ORDERS_LINEITEM') }} "STG_ORDERS_LINEITEM"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_ORDERS_LINEITEM"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_ORDERS_LINEITEM"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_ORDERS_LINEITEM"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_ORDERS_LINEITEM"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_ORDERS_LINEITEM"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_ORDERS_LINEITEM"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 6ed5600f-8305-4e4b-9679-51f0016b5eea
